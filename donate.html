<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css"> 
    <link rel="stylesheet" href="assets/css/util.css">  
    <link rel="stylesheet" href="assets/css/sweetalert2.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;500;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/donations.css" type="text/css" />
    <title>Gokolect- Focussed on social good of the society where giving is the life style of every man.| Donations</title>
</head>
<body>
    <main class="don-container">
        <section class="don-content">
            <a href="index.html" class="text-decoration-none"><img src="assets/images/Gokolectlogo 1.png" alt="Gokolect Logo" class="responsive-img go-logo" /></a>
            <div class="don-message me-3">
                
                <h2 class="text-title text-light ps-3 pe-2">Help us do more!</h2>
                <p class="text-light ps-3 pe-2 my-3">
                    We will get right to the point: We are asking you to support us. We are a none-profit that relies on support from people like you. our focus is to make it possible for people to give freely as much as they can give, and we want to continue through your support.
                </p>
                <hr />
                <h3 class="text-light text-center ps-3 my-2">
                    Thank you for Donating!
                </h3>
            </div>
            <div class="don-form">
                <form action="#" id="donationForm">
                <!-- <form action="../gokolect_api/make_payment" method="POST" id="donationForm"> -->
                    <div class="don-form d-flex flex-column">
                        <input type="hidden" name="payment_options" value=""/>
                        <!-- Can be card, account, ussd, qr, mpesa, mobilemoneyghana  (optional) -->
                        <input type="hidden" name="description" value="Donation to Gokolect Services"/>
                        <!-- Replace the value with your transaction description -->
                        <input type="hidden" name="logo" value="http://brandmark.io/logo-rank/random/apple.png"/>
                        <!-- Replace the value with your logo url (optional) -->
                        <input type="hidden" name="title" value="Gokolect"/>
                        <div class="form-group mx-2 p-2">
                            <label for="country" class="text-light">Select Country</label>
                            <select name="country" id="country" class="form-control select2 rounded">
                                <option value="">Select a country...</option>
                                <option value="NG">Nigeria</option>
                                <option value="GH">Ghana</option>
                                <option value="USA">USA</option>
                                <option value="UK">UK</option>
                            </select>
                        </div>

                        <div class="form-group mx-2 p-2">
                            <label for="currency" class="text-light">Select a currency</label>
                            <select name="currency" id="currency" class="form-control select2 rounded">
                                <option value="">Select a currency...</option>
                                <option value="USD">Dollar</option>
                                <option value="NGN">Naira</option>
                                <option value="YEN">Yen</option>
                                <option value="EUR">Euro</option>
                            </select>
                        </div>
                        <div class="form-group mx-2 p-2">
                            <label for="amount" class="text-light">Amount to Donate</label>
                            <input type="text" name="amount" id="amount" placeholder="Amount" class="form-control rounded" />
                        </div>
                        <div class="form-group mx-2 p-2">
                            <label for="firstname" class="text-light">First Name</label>
                            <input type="text" name="firstname" id="firstname" placeholder="First name" class="form-control rounded" />
                        </div>
                        <div class="form-group mx-2 p-2">
                            <label for="lastname" class="text-light">Last Name</label>
                            <input type="text" name="lastname" id="lastname" placeholder="Last Name" class="form-control rounded" />
                        </div>
                        <div class="form-group mx-2 p-2">
                            <label for="email" class="text-light">Email</label>
                            <input type="email" name="email" id="email" class="form-control rounded" placeholder="Email" />
                        </div>
                        <div class="form-group mx-2 p-2">
                            <label for="phonenumber" class="text-light">Mobile Number</label>
                            <input type="tel" name="phonenumber" id="phonenumber" class="form-control rounded" placeholder="Mobile Number" />
                        </div>
                        <div class="form-group mx-2 p-2">
                            <label for="comment" class="text-light">Comment</label>
                            <textarea rows="5" cols="10" name="comment" id="comment" class="form-control rounded" placeholder="Comment"></textarea>
                        </div>

                        <input type="hidden" name="pay_button_text" value="Complete Payment"/>
                        <!-- Replace the value with the payment button text you prefer (optional) -->
                        <!-- <input type="hidden" name="ref" value="MY_NAME_5a22a7f270abc8879"/> -->
                        <!-- <input type="hidden" name="payRef" id="payRef"/> -->
                        <!-- <input type="hidden" name="action" id="make_payment" value="make_payment" /> -->
                        <!-- Replace the value with your transaction reference. It must be unique per transaction. You can delete this line if you want one to be generated for you. -->

                        <!-- <input type="hidden" name="successurl" value="?process_payment&status=successful" /> -->
                        <!-- Put your success url here -->
                        <!-- <input type="hidden" name="failureurl" value="?process_payment&status=failed" /> -->
                        <div class="form-group mx-2 p-2">
                            <input id="btn-of-destiny" class="btn btn-warning" type="submit" value="Pay Now">
                        </div>
                    </div>
                    
                </form>
                <div class="mx-2 p-2 my-1 col-12 d-flex justify-content-end">
                    <button type="button" class="btn btn-primary rounded col-4 me-4" id="donationBtn">
                        Donate
                    </button>
                </div>
                <div class="form-group mx-2 ps-2 col-12">
                    <a href="#" class="pointer text-light text-decoration-none text-right" id="loadModal">Click here to make a transfer</a>
                </div>
            </div>
        </section>

        <div class="modal fade" id="transferModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="transferModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                
                <div class="modal-body">
                    <form action="#" class="col-12" id="smsForm">
                        <h4 class="text-muted p-2 my-2">
                            Make your donations via transfer
                        </h4>
                        <small class="text-muted p-2">You will receive an SMS with a code to make your transfer<span class="text-danger">*</span></small>
                        <div class="form-group p-2 my-2">
                            <input type="tel" name="phone_transfer" id="phone_transfer" class="form-control rounded" placeholder="Enter your phone number: (+120382847863)" required /> 
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success btn-sm" id="sendNumberBtn">Send</button>
                    <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Close</button>
                </div>
              </div>
            </div>
        </div>
    </main>

    <script src="assets/js/jQuery3.6.0.js"></script>
    <script src="assets/js/jquery_block_ui.js"></script>
    <script src="assets/js/sweetalert2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/jquery.cookie.js"></script>

    <script>
        $.ajaxSetup({
            headers: {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            }
        });

        
        $(document).ready(function() {
            getPaymentRef();

            $("#loadModal").click(function(e) {
                $("#transferModal").modal("show");
            });

            $("#donationBtn").click(function(e) {
                processPayment(e)
            });
        });

        $(document).ajaxStart($.blockUI()).ajaxStop($.unblockUI());

        function getPaymentRef() {
            $.ajax({
                url: 'https://gokolectapp.bootqlass.com/',
                type: 'POST',
                dataType: 'JSON',
                data: {
                    "action": "generate_ref_payment"
                },
                headers: {
                    Authorization: `Bearer ${$.cookie('_jwtp')}`                    
                },
                success: function(json) {			
                    if (json.statuscode === 0) {
                        console.log(json);
                        const data = json.data
                        $("#payRef").val(data);                      
                    } else {              
                        console.log(json.status);
                    }
                },
                error: function(xhr, status, error) {			
                    // window.location.href = '../units/signin.html';
                    console.log(xhr.responseText);
                }
            });
        }

        function processPayment(e) {
            e.preventDefault();
            let formData = new FormData(donationForm); 
            formData.append('action', 'process_payment');   
            $.ajax({
                url: "https://gokolectapp.bootqlass.com/",
                type: "POST",
                data: formData,
                headers: {
                    Authorization: `Bearer ${$.cookie('_jwtp')}`
                },
                contentType: false,
                cache: false,
                processData: false,
                dataType: 'JSON',
                success: function(link){
                    const url = new URL(JSON.stringify(link))
                    console.log(url)
                    // window.location.replace = url;
                    // $.globalEval(html);                     
                    // $(document).ready(function(){
                    //     document.write(html);
                    // });               
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    console.log(errorThrown);
                    console.log(jqXHR);
                    console.log(textStatus);
                    // $(document).ready(function(){
                    //     document.write(jqXHR.responseText);
                    // });  
                    // Swal.fire({
                    //     title: "Error",
                    //     html: jqXHR.responseText,
                    //     icon: "error",
                    //     confirmButtonText: "Ok"
                    // });
                }
            });
        }    
        
    </script>
</body>
</html>